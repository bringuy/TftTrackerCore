{"ast":null,"code":"const Promise = require('pinkie-promise');\n\nconst exec = require('child_process').exec;\n\nconst path = require('path');\n\nconst defaultAll = require('../utils').defaultAll;\n\nconst EXAMPLE_DISPLAYS_OUTPUT = `Screen 0: minimum 320 x 200, current 5760 x 1080, maximum 8192 x 8192\neDP-1 connected (normal left inverted right x axis y axis)\n  2560x1440     60.00 +\n  1920x1440     60.00\n  1856x1392     60.01\n  1792x1344     60.01\n  1920x1200     59.95\n  1920x1080     59.93\n  1600x1200     60.00\n  1680x1050     59.95    59.88\n  1600x1024     60.17\n  1400x1050     59.98\n  1280x1024     60.02\n  1440x900      59.89\n  1280x960      60.00\n  1360x768      59.80    59.96\n  1152x864      60.00\n  1024x768      60.04    60.00\n  960x720       60.00\n  928x696       60.05\n  896x672       60.01\n  960x600       60.00\n  960x540       59.99\n  800x600       60.00    60.32    56.25\n  840x525       60.01    59.88\n  800x512       60.17\n  700x525       59.98\n  640x512       60.02\n  720x450       59.89\n  640x480       60.00    59.94\n  680x384       59.80    59.96\n  576x432       60.06\n  512x384       60.00\n  400x300       60.32    56.34\n  320x240       60.05\nDP-1 disconnected (normal left inverted right x axis y axis)\nHDMI-1 connected primary 1920x1080+0+0 (normal left inverted right x axis y axis) 476mm x 268mm\n  1920x1080     60.00*+  50.00    50.00    59.94\n  1680x1050     59.88\n  1600x900      60.00\n  1280x1024     60.02\n  1440x900      59.90\n  1280x800      59.91\n  1280x720      60.00    50.00    59.94\n  1024x768      60.00\n  800x600       60.32\n  720x576       50.00\n  720x480       60.00    59.94\n  640x480       60.00    59.94\n  720x400       70.08\nDP-2 disconnected (normal left inverted right x axis y axis)\nHDMI-2 disconnected (normal left inverted right x axis y axis)\nDP-2-1 connected 1920x1080+3840+0 (normal left inverted right x axis y axis) 476mm x 268mm\n  1920x1080     60.00*+  50.00    50.00    59.94\n  1680x1050     59.88\n  1600x900      60.00\n  1280x1024     60.02\n  1440x900      59.90\n  1280x800      59.91\n  1280x720      60.00    50.00    59.94\n  1024x768      60.00\n  800x600       60.32\n  720x576       50.00\n  720x480       60.00    59.94\n  640x480       60.00    59.94\n  720x400       70.08\nDP-2-2 connected 1920x1080+1920+0 (normal left inverted right x axis y axis) 476mm x 268mm\n  1920x1080     60.00*+  50.00    50.00    59.94\n  1680x1050     59.88\n  1600x900      60.00\n  1280x1024     60.02\n  1440x900      59.90\n  1280x800      59.91\n  1280x720      60.00    50.00    59.94\n  1024x768      60.00\n  800x600       60.32\n  720x576       50.00\n  720x480       60.00    59.94\n  640x480       60.00    59.94\n  720x400       70.08\nDP-2-3 disconnected (normal left inverted right x axis y axis)`;\n\nfunction parseDisplaysOutput(out) {\n  return out.split('\\n').filter(line => line.indexOf(' connected ') > 0).filter(line => line.search(/\\dx\\d/) > 0).map((line, ix) => {\n    const parts = line.split(' ');\n    const name = parts[0];\n    const primary = parts[2] === 'primary';\n    const crop = primary ? parts[3] : parts[2];\n    const resParts = crop.split(/[x+]/);\n    const width = +resParts[0];\n    const height = +resParts[1];\n    const offsetX = +resParts[2];\n    const offsetY = +resParts[3];\n    return {\n      width,\n      height,\n      name,\n      id: name,\n      offsetX,\n      offsetY,\n      primary,\n      crop\n    };\n  });\n}\n\nfunction listDisplays() {\n  return new Promise((resolve, reject) => {\n    exec('xrandr', (err, stdout) => {\n      if (err) {\n        return reject(err);\n      }\n\n      return resolve(parseDisplaysOutput(stdout));\n    });\n  });\n}\n\nfunction maxBuffer(screens) {\n  let total = 0;\n  screens.forEach(screen => {\n    total += screen.height * screen.width;\n  });\n  return total;\n}\n\nfunction guessFiletype(filename) {\n  switch (path.extname(filename)) {\n    case '.jpg':\n    case '.jpeg':\n      return 'jpeg';\n\n    case '.png':\n      return 'png';\n  }\n\n  return 'jpeg';\n}\n\nfunction linuxSnapshot(options = {}) {\n  return new Promise((resolve, reject) => {\n    listDisplays().then(screens => {\n      const screen = screens.find(options.screen ? screen => screen.id === options.screen : screen => screen.primary || screen.id === 'default') || screens[0];\n      const filename = options.filename ? options.filename.replace(/\"/g, '\\\\\"') : '-';\n      const execOptions = options.filename ? {} : {\n        encoding: 'buffer',\n        maxBuffer: maxBuffer(screens)\n      };\n      const filetype = options.format || guessFiletype(filename);\n      let commandLine = '';\n\n      switch (options.linuxLibrary) {\n        case 'scrot':\n          // Faster. Does not support crop.\n          commandLine = `scrot \"${filename}\" -e -z \"echo \\\\\"${filename}\\\\\"\"`;\n          break;\n\n        case 'imagemagick':\n        default:\n          commandLine = `import -silent -window root -crop ${screen.crop} -screen ${filetype}:\"${filename}\" `;\n          break;\n      }\n\n      exec(commandLine, execOptions, (err, stdout) => {\n        if (err) {\n          return reject(err);\n        } else {\n          return resolve(options.filename ? path.resolve(options.filename) : stdout);\n        }\n      });\n    });\n  });\n}\n\nlinuxSnapshot.listDisplays = listDisplays;\nlinuxSnapshot.parseDisplaysOutput = parseDisplaysOutput;\nlinuxSnapshot.EXAMPLE_DISPLAYS_OUTPUT = EXAMPLE_DISPLAYS_OUTPUT;\n\nlinuxSnapshot.all = () => defaultAll(linuxSnapshot);\n\nmodule.exports = linuxSnapshot;","map":{"version":3,"sources":["C:/Users/Brian/Desktop/TFTracker/TftTrackerCore/tfttracker-frontend/node_modules/screenshot-desktop/lib/linux/index.js"],"names":["Promise","require","exec","path","defaultAll","EXAMPLE_DISPLAYS_OUTPUT","parseDisplaysOutput","out","split","filter","line","indexOf","search","map","ix","parts","name","primary","crop","resParts","width","height","offsetX","offsetY","id","listDisplays","resolve","reject","err","stdout","maxBuffer","screens","total","forEach","screen","guessFiletype","filename","extname","linuxSnapshot","options","then","find","replace","execOptions","encoding","filetype","format","commandLine","linuxLibrary","all","module","exports"],"mappings":"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","sourcesContent":["const Promise = require('pinkie-promise')\nconst exec = require('child_process').exec\nconst path = require('path')\nconst defaultAll = require('../utils').defaultAll\n\nconst EXAMPLE_DISPLAYS_OUTPUT = `Screen 0: minimum 320 x 200, current 5760 x 1080, maximum 8192 x 8192\neDP-1 connected (normal left inverted right x axis y axis)\n  2560x1440     60.00 +\n  1920x1440     60.00\n  1856x1392     60.01\n  1792x1344     60.01\n  1920x1200     59.95\n  1920x1080     59.93\n  1600x1200     60.00\n  1680x1050     59.95    59.88\n  1600x1024     60.17\n  1400x1050     59.98\n  1280x1024     60.02\n  1440x900      59.89\n  1280x960      60.00\n  1360x768      59.80    59.96\n  1152x864      60.00\n  1024x768      60.04    60.00\n  960x720       60.00\n  928x696       60.05\n  896x672       60.01\n  960x600       60.00\n  960x540       59.99\n  800x600       60.00    60.32    56.25\n  840x525       60.01    59.88\n  800x512       60.17\n  700x525       59.98\n  640x512       60.02\n  720x450       59.89\n  640x480       60.00    59.94\n  680x384       59.80    59.96\n  576x432       60.06\n  512x384       60.00\n  400x300       60.32    56.34\n  320x240       60.05\nDP-1 disconnected (normal left inverted right x axis y axis)\nHDMI-1 connected primary 1920x1080+0+0 (normal left inverted right x axis y axis) 476mm x 268mm\n  1920x1080     60.00*+  50.00    50.00    59.94\n  1680x1050     59.88\n  1600x900      60.00\n  1280x1024     60.02\n  1440x900      59.90\n  1280x800      59.91\n  1280x720      60.00    50.00    59.94\n  1024x768      60.00\n  800x600       60.32\n  720x576       50.00\n  720x480       60.00    59.94\n  640x480       60.00    59.94\n  720x400       70.08\nDP-2 disconnected (normal left inverted right x axis y axis)\nHDMI-2 disconnected (normal left inverted right x axis y axis)\nDP-2-1 connected 1920x1080+3840+0 (normal left inverted right x axis y axis) 476mm x 268mm\n  1920x1080     60.00*+  50.00    50.00    59.94\n  1680x1050     59.88\n  1600x900      60.00\n  1280x1024     60.02\n  1440x900      59.90\n  1280x800      59.91\n  1280x720      60.00    50.00    59.94\n  1024x768      60.00\n  800x600       60.32\n  720x576       50.00\n  720x480       60.00    59.94\n  640x480       60.00    59.94\n  720x400       70.08\nDP-2-2 connected 1920x1080+1920+0 (normal left inverted right x axis y axis) 476mm x 268mm\n  1920x1080     60.00*+  50.00    50.00    59.94\n  1680x1050     59.88\n  1600x900      60.00\n  1280x1024     60.02\n  1440x900      59.90\n  1280x800      59.91\n  1280x720      60.00    50.00    59.94\n  1024x768      60.00\n  800x600       60.32\n  720x576       50.00\n  720x480       60.00    59.94\n  640x480       60.00    59.94\n  720x400       70.08\nDP-2-3 disconnected (normal left inverted right x axis y axis)`\n\nfunction parseDisplaysOutput (out) {\n  return out\n    .split('\\n')\n    .filter(line => line.indexOf(' connected ') > 0)\n    .filter(line => line.search(/\\dx\\d/) > 0)\n    .map((line, ix) => {\n      const parts = line.split(' ')\n      const name = parts[0]\n      const primary = parts[2] === 'primary'\n      const crop = primary ? parts[3] : parts[2]\n      const resParts = crop.split(/[x+]/)\n      const width = +resParts[0]\n      const height = +resParts[1]\n      const offsetX = +resParts[2]\n      const offsetY = +resParts[3]\n\n      return {\n        width,\n        height,\n        name,\n        id: name,\n        offsetX,\n        offsetY,\n        primary,\n        crop\n      }\n    })\n}\n\nfunction listDisplays () {\n  return new Promise((resolve, reject) => {\n    exec('xrandr', (err, stdout) => {\n      if (err) {\n        return reject(err)\n      }\n      return resolve(parseDisplaysOutput(stdout))\n    })\n  })\n}\n\nfunction maxBuffer (screens) {\n  let total = 0\n  screens.forEach((screen) => {\n    total += screen.height * screen.width\n  })\n  return total\n}\n\nfunction guessFiletype (filename) {\n  switch (path.extname(filename)) {\n    case '.jpg':\n    case '.jpeg':\n      return 'jpeg'\n    case '.png':\n      return 'png'\n  }\n\n  return 'jpeg'\n}\n\nfunction linuxSnapshot (options = {}) {\n  return new Promise((resolve, reject) => {\n    listDisplays().then((screens) => {\n      const screen = screens.find(options.screen ? screen => screen.id === options.screen : screen => screen.primary || screen.id === 'default') || screens[0]\n\n      const filename = options.filename ? (options.filename.replace(/\"/g, '\\\\\"')) : '-'\n      const execOptions = options.filename ? {} : {\n        encoding: 'buffer',\n        maxBuffer: maxBuffer(screens)\n      }\n      const filetype = options.format || guessFiletype(filename)\n\n      let commandLine = ''\n      switch (options.linuxLibrary) {\n        case 'scrot': // Faster. Does not support crop.\n          commandLine = `scrot \"${filename}\" -e -z \"echo \\\\\"${filename}\\\\\"\"`\n          break\n        case 'imagemagick':\n        default:\n          commandLine = `import -silent -window root -crop ${screen.crop} -screen ${filetype}:\"${filename}\" `\n          break\n      }\n\n      exec(\n        commandLine,\n        execOptions,\n        (err, stdout) => {\n          if (err) {\n            return reject(err)\n          } else {\n            return resolve(options.filename ? path.resolve(options.filename) : stdout)\n          }\n        })\n    })\n  })\n}\n\nlinuxSnapshot.listDisplays = listDisplays\nlinuxSnapshot.parseDisplaysOutput = parseDisplaysOutput\nlinuxSnapshot.EXAMPLE_DISPLAYS_OUTPUT = EXAMPLE_DISPLAYS_OUTPUT\nlinuxSnapshot.all = () => defaultAll(linuxSnapshot)\nmodule.exports = linuxSnapshot\n"]},"metadata":{},"sourceType":"script"}